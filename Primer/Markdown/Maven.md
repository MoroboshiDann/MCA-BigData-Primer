# Maven仓库

Maven仓库是基于简单文件系统存储的，集中化管理Java API资源(构件)的一个服务。

仓库中的任何一个构件都有其唯一的**坐标**，根据这个坐标可以定义其在仓库中的唯一存储路径。得益于Maven的坐标机制，任何Maven项目使用任何一个构件的方式都是完全相同的。

Maven可以在某个统一位置存储所有的Maven项目共享的构件，这个统一的位置就是**仓库**，项目构建完毕后生成的构件也可以安装或者部署到仓库中，供其他项目使用。

对于Maven来说，仓库可以分为两类：本地仓库和远程仓库

## 远程仓库

不在本机中的一切仓库，都是远程仓库，分为：中央仓库和本地私服仓库

远程仓库是指通过各种协议，如`file://`, `http://`访问的其他类型的仓库。这些仓库可能是第三方搭建的真实的远程仓库，用来提供下载他们的构件。其他“远程仓库”可能是你的公司拥有的建立在文件或者HTTP服务i其上的内部仓库，用来在开发团队见共享私有构件和管理发布的。

默认的远程仓库使用的是Apache提供的中央仓库：`https://mvnrepository.com/`

## 本地仓库

本地仓库是指本机的一份拷贝，用来缓存远程下载，包含本地尚未发布的临时构件。



## 仓库配置

在`settings.xml`文件中，可以修改本地仓库和镜像仓库的位置。

镜像仓库是指该仓库是中央仓库的一个副本，通常由于下载速度等原因进行替换。



## 仓库优先级

![image-20240114103851706](..\img\mvnRepository.png)



# Maven工程类型

## POM工程

POM工程是逻辑工程，用在父级工程或聚合工程中，用来做jar包的版本控制。

## JAR工程

工程会被打包为jar包，常见的本地工程 --> Java Project

## WAR工程

工程会被打包为war包，发布在服务器上的工程。



# IDEA中创建Maven工程

- GroupId：域名反写
- ArtifactId：项目名
- Version：版本

这三者就是这个项目的坐标

## 目录结构

- src
  - main
    - java 
      - 存储Java源代码
    - resources
      - 存储主要的资源文件，如xml配置文件和properties文件
  - test
    - java
      - 存储测试使用的类，如JUNIT的测试
    - resources
      - 可以自己创建，存储测试环境使用的资源文件
- target
  - 存放编译后的内容



# POM模式-Maven工程关系

## 依赖

如果A工程开发或运行过程中需要B工程支持，则代表A工程依赖B工程。

在这种情况下，需要在A工程的pom.xml文件中增加下属配置定义依赖关系。

B工程 --注入--> A工程

B工程 <--依赖-- A工程

通俗理解就是导jar包

导包的方式为：

在pom.xml文件中，根元素<project>标签下的<dependencies>标签中，配置依赖信息。内部可以包含多个<dependency>标签，以声明多个依赖。每个依赖都应该包含 <groupId> <artifactId>和<version>三部分。对于一个依赖来说，基本坐标是最重要的，Maven根据坐标才能找到需要的依赖。

### 依赖的传递性

如果当前工程依赖的某个工程也依赖于其他工程，则无需在当前工程中导入那些被依赖的jar包，只需要加上直接依赖的库，Maven会隐式地把这些库简介依赖的库自动导入。

## 依赖的两个原则

### 第一原则：最短路径优先原则

项目依赖关系树中路径最短的版本会被使用。

如，假设A, B, C之间的依赖关系是A -> B -> C -> D(2.0) 和 A -> E -> D(1.0)。那么D(1.0)会被使用，因为A到其的路径最短

### 第二原则：最先声明原则

依赖路径长度是一样的时候，第一原则不能解决所有的问题，为了尽可能避免构建的不确定性，maven定义了依赖调解的第二原则：第一声明者优先。在pom.xml文件中的声明顺序决定了谁会被解析使用。



## 依赖范围

<scope>标签决定了依赖坐标在什么情况下有效

- compile：默认范围，表示该依赖在编译和运行时都有效
- provided：编译和测试项目的时候需要该依赖，但是在项目运行时，由于容器已经提供，就不需要Maven重复地引入。依赖仅在编译时有效
- runtime：依赖仅在运行时生效，编译时不生效

## 继承

使用<parent>标签来指定父工程的坐标

子工程默认依赖父工程所有的依赖，且可以应用父工程中定义的所有资源信息。

## 聚合

聚合时多个项目本质上还是一个项目，这些项目被一个大的父工程包含，且这是父项目类型为POM类型，同时在父项目的pom.xml文件中使用<modules>标签来包含子模块的坐标